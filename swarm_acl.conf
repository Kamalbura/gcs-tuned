# UAVPI ACL for Mosquitto using identity-as-username
# Copy to: C:\mqtt\acl\swarm_acl.conf
# %c is replaced by the client's TLS certificate Common Name (CN)

# GCS gets full access to swarm namespace
user uavpi-gcs
topic readwrite swarm/#

# Drones get least-privilege via CN substitution
# Each client may publish its own status/alert and read broadcasts + its own commands
pattern write swarm/status/%c
pattern write swarm/alert/%c
pattern read  swarm/broadcast/#
pattern read  swarm/commands/individual/%c

# Optional: telemetry read by GCS and write by drones; adjust as needed
# pattern write swarm/drones/%c/telemetry
# user uavpi-gcs
# topic  read swarm/drones/+/telemetry

# UAVPI ACL leveraging client certificate CN via use_identity_as_username
# %c is substituted with the client's certificate Common Name (CN)

# Ground Control Station: full access to swarm topics
user uavpi-gcs
topic readwrite swarm/#

# Drones: least-privilege using pattern substitution
# Each drone can publish status/alerts under its own CN, and read broadcasts
pattern write swarm/status/%c
pattern write swarm/alert/%c
pattern read  swarm/broadcast/#
pattern read  swarm/commands/individual/%c
